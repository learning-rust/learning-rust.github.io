title: æ¨¡å— - Modules
---

## 01. æ–‡ä»¶å†…æ¨¡å—

ç›¸å…³è”çš„ä»£ç ä¸Žæ•°æ®ä¸Žä»£ç ç»„ç»‡ä¸ºä¸€ä¸ªæ¨¡å—å¹¶ä¸Žå…¶ä»–ä»£ç å­˜æ”¾åœ¨åŒä¸€æ–‡ä»¶å†…ã€‚

```rust
fn main() {
   greetings::hello();
}

mod greetings {
  // â­ï¸ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—å†…éƒ¨çš„æ‰€æœ‰æˆå‘˜éƒ½æ˜¯ç§æœ‰çš„
  pub fn hello() { // â­ï¸ æ‰€ä»¥éœ€è¦åœ¨å‡½æ•°å‰å¢žåŠ pubå…³é”®å­—ä½¿å…¶å˜ä¸ºpublicæˆå‘˜å¹¶èƒ½è¢«å¤–éƒ¨è®¿é—®
    println!("Hello, world!");
  }
}
```

æ¨¡å—å¯ä»¥å¤šå±‚åµŒå¥—ã€‚

```rust
fn main() { 
  phrases::greetings::hello();
}

mod phrases { 
  pub mod greetings { 
    pub fn hello() { 
      println!("Hello, world!");
    }
  }
}
```

ç§æœ‰æ–¹æ³•ä¹Ÿå¯ä»¥è¢«åŒçº§æ¨¡å—æˆ–å­çº§æ¨¡å—çš„å…¶ä»–æˆå‘˜è®¿é—®åˆ°ã€‚

```rust
// 01. åŒä¸€æ¨¡å—å†…è°ƒç”¨ç§æœ‰å‡½æ•°
fn main() {
  phrases::greet();
}

mod phrases {
  pub fn greet() {
    hello(); // æˆ–ä½¿ç”¨ `self::hello();`
  }
  
  fn hello() {
    println!("Hello, world!");
  }
}

// 02. è°ƒç”¨çˆ¶çº§æ¨¡å—ä¸­çš„ç§æœ‰å‡½æ•°
fn main() {
  phrases::greetings::hello();
}

mod phrases {
  fn private_fn() {
    println!("Hello, world!");
  }
  
  pub mod greetings {
    pub fn hello() {
      super::private_fn();
    }
  }
}
```

> ðŸ’¡ `self`å…³é”®å­—ç”¨æ¥å¼•ç”¨åŒä¸€æ¨¡å—ï¼Œç›¸åº”çš„ï¼Œ`super`å…³é”®å­—ç”¨æ¥å¼•ç”¨çˆ¶çº§æ¨¡å—ã€‚æ­¤å¤–ï¼Œä¸€ä¸ªæ¨¡å—ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨`super`æ¥è®¿é—®æ ¹å‡½æ•°ä¸­çš„å†…å®¹ã€‚

```rust
fn main() {
  greetings::hello();
}

fn hello() {
  println!("Hello, world!");
}

mod greetings {
  pub fn hello() {
    super::hello();
  }
}
```

> ðŸ”Ž åœ¨ç¼–å†™æµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œä¸€ä¸ªå¾ˆå¥½çš„å®žè·µæ˜¯å°†å…¶åŒ…è£¹åœ¨testæ¨¡å—ä¸­ï¼Œè¿™æ ·ä»…åœ¨æµ‹è¯•æ—¶ä¼šå¯¹è¯¥æ¨¡å—è¿›è¡Œç¼–è¯‘ã€‚

```rust
fn greet() -> String {
    "Hello, world!".to_string()
}

#[cfg(test)] // ä»…åœ¨è¿›è¡Œæµ‹è¯•æ—¶è¿›è¡Œç¼–è¯‘
mod tests {
    use super::greet; // å¼•å…¥æ ¹éƒ¨çš„greetå‡½æ•°

    #[test]
    fn test_greet() {
        assert_eq!("Hello, world!", greet());
    }
}
```

## 02. åŒä¸€æ–‡ä»¶å¤¹çš„ä¸åŒæ–‡ä»¶

```rust
// â†³ main.rs
mod greetings; // å¼•å…¥greetingsæ¨¡å—

fn main() {
  greetings::hello();
}

// â†³ greetings.rs
// â­ï¸ å¹¶ä¸éœ€è¦å°†æ¨¡å—åŒ…è£¹åœ¨ä¸€ä¸ªmodå£°æ˜Žä¸­ã€‚ä¸€ä¸ªæ–‡ä»¶æœ¬èº«å°±æ‰®æ¼”è€…ä¸€ä¸ªæ¨¡å—çš„è§’è‰²ã€‚
pub fn hello() { // å‡½æ•°éœ€è¦ä½œä¸ºå…¬æœ‰æˆå‘˜æ‰èƒ½è¢«å¤–éƒ¨è®¿é—®åˆ°ã€‚
  println!("Hello, world!");
}
```

å¦‚æžœä¸€ä¸ªæ–‡ä»¶é‡ŒåŒ…å«ä¸€ä¸ª`mod`å£°æ˜Žï¼Œæ‰€å£°æ˜Žçš„æ¨¡å—å°†è¢«è®¤ä¸ºæ˜¯åµŒå¥—æ¨¡å—ã€‚

```rust
// â†³ main.rs
mod phrases;

fn main() {
  phrases::greetings::hello();
}

// â†³ phrases.rs
pub mod greetings { // â­ï¸è¯¥æ¨¡å—éœ€è¦ä½œä¸ºpublicæ¨¡å—æ‰å¯ä»¥è¢«å¤–éƒ¨è®¿é—®åˆ°
  pub fn hello() {
    println!("Hello, world!");
  }
}
```

## 03. ä¸åŒæ–‡ä»¶å¤¹ä¸‹çš„ä¸åŒæ–‡ä»¶

`mod.rs` in the directory module root is the entry point to the directory module. All other files in that directory root, act as sub-modules of the directory module.

```rust
// â†³ main.rs
mod greetings;

fn main() {
  greetings::hello();
}

// â†³ greetings/mod.rs
pub fn hello() { // â­ï¸ The function has to be public to access from outside
  println!("Hello, world!");
}
```

Again, If we wrap file content with a `mod` declaration, it will act as a nested module.

```rust
// â†³ main.rs
mod phrases;

fn main() {
  phrases::greetings::hello();
}

// â†³ phrases/mod.rs
pub mod greetings { // â­ï¸ The module has to be public to access from outside
  pub fn hello() {
    println!("Hello, world!");
  }
}
```

Other files in the directory module act as sub-modules for `mod.rs`.

```rust
// â†³ main.rs
mod phrases;

fn main() {
  phrases::hello()
}

// â†³ phrases/mod.rs
mod greetings;

pub fn hello() {
  greetings::hello()
}

// â†³ phrases/greetings.rs
pub fn hello() {
  println!("Hello, world!");
}
```

â­ï¸ If you need to access an element of `phrases/greetings.rs` from outside the module, you have to import the `greetings` module as a public module.

```rust
// â†³ main.rs
mod phrases;

fn main() {
    phrases::greetings::hello();
}

// â†³ phrases/mod.rs
pub mod greetings;  // â­ï¸ `pub mod` instead `mod`

// â†³ phrases/greetings.rs
pub fn hello() {
  println!("Hello, world!");
}
```

> ðŸ”Ž Itâ€™s unable to import child file modules of directory modules to `main.rs`, so you canâ€™t use `mod phrases::greetings;` from `main.rs`. But there is a way to import `phrases::greetings::hello()` to `phrases` module by re-exporting `hello` to `phrases` module. So you can call it directly as `phrases::hello()`.

```rust
// â†³ phrases/greetings.rs
pub fn hello() {
  println!("Hello, world!");
}

// â†³ phrases/mod.rs
pub mod greetings;

pub use self::greetings::hello; // Re-export `greetings::hello` to phrases

// â†³ main.rs
mod phrases;

fn main() {
    phrases::hello(); // You can call `hello()` directly from phrases
}
```

This allows you to present an external interface that **may not directly map** to your internal code organization. If still it is not clear, donâ€™t worry; We discuss the usages of `use` on an upcoming section in this post.
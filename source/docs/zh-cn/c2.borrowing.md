title: å€Ÿç”¨
---

åœ¨ä¸€ä¸ªå®é™…çš„åº”ç”¨ä¸­ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬éƒ½æœ‰éœ€è¦å°†ä¸€ä¸ªå˜é‡ç»‘å®šä¼ é€’ç»™å‡½æ•°æˆ–èµ‹å€¼ç»™å¦ä¸€ä¸ªå‡½æ•°ã€‚è¿™ç§æƒ…å½¢ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥**å¼•ç”¨**åŸå§‹ç»‘å®šï¼Œ**å€Ÿç”¨**å…¶ç»‘å®šçš„æ•°æ®ã€‚

## ä½•ä¸ºâ€œå€Ÿç”¨â€?

> [å€Ÿç”¨ \(verb\)](https://github.com/nikomatsakis/rust-tutorials-keynote/blob/master/Ownership%20and%20Borrowing.pdf)  
> å–å¾—æŸäº‹ç‰©å¹¶çº¦å®šæœªæ¥å°†å½’è¿˜ã€‚ 

## å…±äº«å€Ÿç”¨ & å¯å˜å€Ÿç”¨

â­ï¸ å€Ÿç”¨æœ‰ä¸¤ç§ç±»å‹,

1. **å…±äº«å€Ÿç”¨** `(&T)`

   * ä¸€æ®µæ•°æ®å¯ä»¥**è¢«ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·å€Ÿç”¨**ï¼Œä½†**æ•°æ®ä¸å¯è¿›è¡Œä¿®æ”¹**ã€‚

2. **å¯å˜å€Ÿç”¨** `(&mut T)`

   * ä¸€æ®µæ•°æ®å¯ä»¥**è¢«ä¸€ä¸ªç”¨æˆ·å€Ÿç”¨å¹¶åŠ ä»¥ä¿®æ”¹**ï¼Œä½†åœ¨å€Ÿç”¨æœŸé—´ï¼Œè¿™æ®µæ•°æ®ä¸å¯è¢«ä»»ä½•å…¶ä»–ç”¨æˆ·æ‰€è®¿é—®ã€‚

## å€Ÿç”¨è§„åˆ™

å€Ÿç”¨æœ‰ä¸€äº›é‡è¦çš„è§„åˆ™ï¼Œ

1. ä¸€æ®µæ•°æ®åœ¨åŒä¸€æ—¶é—´å†…ï¼Œæˆ–æ˜¯å¯ä»¥è¢«å…±äº«å€Ÿç”¨ï¼Œæˆ–æ˜¯å¯ä»¥è¢«å¯å˜å€Ÿç”¨ï¼Œ**ä½†ä¸å¯ä»¥åŒæ—¶ä»¥ä¸¤ç§å½¢å¼è¢«å€Ÿç”¨**ï¼›

2. å€Ÿç”¨**æ—¢å¯å¯¹æ‹·è´ç±»å‹çš„æ•°æ®ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å¯¹è½¬ç§»ç±»å‹çš„æ•°æ®ä½¿ç”¨**ï¼›

3. è¦æ³¨æ„**å­˜æ´»æœŸ** â†´
```rust

fn main() {
    let mut a = [1, 2, 3];
    let b = &mut a; // æ­¤å¤„å‘ç”Ÿä¸€ä¸ªå¯å˜å€Ÿç”¨
    println!("b: {:?}, a: {:?}", b, a); // æŠ›é”™ï¼ŒåŒä¸€æ—¶é—´ä½¿ç”¨å¯å˜å€Ÿç”¨å’Œä¸å¯å˜å€Ÿç”¨
}
```

```rust 2015
// Rust 2015
fn main() {
  let mut a = vec![1, 2, 3];
  let b = &mut a;  //  å¯å˜å€Ÿç”¨æ­¤å¤„å¼€å§‹
                   //  â
  // some code     //  â
  // some code     //  â
}                  //  å¯å˜å€Ÿç”¨æ­¤å¤„ç»“æŸ

fn main() {
  let mut a = vec![1, 2, 3];
  let b = &mut a;  // æ­¤å¤„å‘ç”Ÿäº†ä¸€ä¸ªå¯å˜å€Ÿç”¨
  // some code

  println!("{:?}", a); // æ­¤å¤„æƒ³ä»¥å…±äº«å€Ÿç”¨çš„æ–¹å¼è®¿é—®æ•°æ®ï¼ŒæŠ›é”™
}                  //  å¯å˜å€Ÿç”¨æ­¤å¤„æ‰ç»“æŸ

fn main() {
  let mut a = vec![1, 2, 3];
  {
    let b = &mut a;  //  æ­¤å¤„å‘ç”Ÿäº†ä¸€ä¸ªå¯å˜å€Ÿç”¨
    // any other code
  }                  //  ä½¿ç”¨èŠ±æ‹¬å·æ ‡è®°ä¸€ä¸ªä»£ç å—çš„èŒƒå›´ï¼Œç¦»å¼€ä»£ç å—åï¼Œå¯å˜å¼•ç”¨ç»“æŸ

  println!("{:?}", a); // æ­¤å¤„å…è®¸é‡æ–°ä»¥å…±äº«å€Ÿç”¨çš„æ–¹å¼è®¿é—®æ•°æ®
}
```
```rust 2018
// Rust 2018
fn main() {
  let mut a = vec![1, 2, 3];
  let b = &mut a;  //  æ­¤å¤„å‘ç”Ÿäº†ä¸€ä¸ªå¯å˜å€Ÿç”¨
  // some code
                       // åœ¨æ­¤ä¹‹åæ²¡æœ‰å¯¹äºå¯å˜å¼•ç”¨çš„ä½¿ç”¨ï¼ŒRust2018ä¼šæ¨æµ‹å¯å˜å¼•ç”¨ç”Ÿå­˜æœŸç»“æŸ
  println!("{:?}", a); // å› ä¸ºä¹‹å‰çš„å¯å˜å€Ÿç”¨å·²ç»“æŸï¼Œæ­¤å¤„åˆé‡æ–°ä»¥å…±äº«å€Ÿç”¨çš„æ–¹å¼è®¿é—®äº†åŸå§‹æ•°æ®
}                  // å…±äº«å€Ÿç”¨æ­¤å¤„ç»“æŸ


```

ğŸ’¡ æˆ‘ä»¬æ¥çœ‹ä¸€äº›å…³äºå…±äº«å’Œå¯å˜å€Ÿç”¨çš„å®é™…ä¾‹å­

### å…±äº«å€Ÿç”¨

```rust
fn main() {
    let a = [1, 2, 3];
    let b = &a;
    println!("{:?} {}", a, b[0]); // [1, 2, 3] 1
}


fn main() {
    let a = vec![1, 2, 3];
    let b = get_first_element(&a);

    println!("{:?} {}", a, b); // [1, 2, 3] 1
}

fn get_first_element(a: &Vec<i32>) -> i32 {
    a[0]
}
```

### å¯å˜å€Ÿç”¨

```rust
fn main() {
    let mut a = [1, 2, 3];
    let b = &mut a;
    b[0] = 4;
    println!("{:?}", b); // [4, 2, 3]
}

// Rust 2015
fn main() {
    let mut a = [1, 2, 3];
    {
        let b = &mut a;
        b[0] = 4;
    }

    println!("{:?}", a); // [4, 2, 3]
}
// Rust 2018
fn main() {
    let mut a = [1, 2, 3];
    let b = &mut a;
    b[0] = 4;

    println!("{:?}", a); // [4, 2, 3]
}


fn main() {
    let mut a = vec![1, 2, 3];
    let b = change_and_get_first_element(&mut a);

    println!("{:?} {}", a, b); // [4, 2, 3] 4
}

fn change_and_get_first_element(a: &mut Vec<i32>) -> i32 {
    a[0] = 4;
    a[0]
}
```
